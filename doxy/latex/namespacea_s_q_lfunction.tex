\section{a\+S\+Q\+Lfunction Namespace Reference}
\label{namespacea_s_q_lfunction}\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \textbf{ on\+\_\+connect} (\textbf{ client}, userdata, flags, rc)
\item 
def \textbf{ on\+\_\+disconnect} (\textbf{ client}, userdata, rc)
\item 
def \textbf{ Send\+User\+\_\+callback} (\textbf{ client}, userdata, message)
\item 
def \textbf{ Update\+\_\+callback} (\textbf{ client}, userdata, message)
\item 
def \textbf{ photon\+Measure\+\_\+callback} (\textbf{ client}, userdata, message)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\textbf{ con} = None
\item 
string \textbf{ broker} = \char`\"{}broker.\+hivemq.\+com\char`\"{}
\item 
string \textbf{ path} = \char`\"{}/media/usb/user\+List\char`\"{}
\item 
int \textbf{ err\+\_\+cnt} = 0
\item 
\textbf{ client} = mqtt.\+Client()
\item 
\textbf{ connected\+\_\+flag}
\item 
\textbf{ bad\+\_\+connection\+\_\+flag}
\item 
\textbf{ on\+\_\+connect}
\item 
\textbf{ on\+\_\+disconnect}
\item 
\textbf{ current\+\_\+time} = time.\+ctime(time.\+time())
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\label{namespacea_s_q_lfunction_a7da290ce6dcb2117b3d70e6981ec1073}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!on\+\_\+connect@{on\+\_\+connect}}
\index{on\+\_\+connect@{on\+\_\+connect}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{on\+\_\+connect()}
{\footnotesize\ttfamily def a\+S\+Q\+Lfunction.\+on\+\_\+connect (\begin{DoxyParamCaption}\item[{}]{client,  }\item[{}]{userdata,  }\item[{}]{flags,  }\item[{}]{rc }\end{DoxyParamCaption})}



Definition at line 17 of file a\+S\+Q\+Lfunction.\+py.



References on\+\_\+connect.


\begin{DoxyCode}
17 \textcolor{keyword}{def }on_connect(client, userdata, flags, rc):
18     \textcolor{keywordflow}{if} rc == 0:
19         \textcolor{comment}{#print("Connection start")}
20         client.bad\_connection\_flag = \textcolor{keyword}{False}
21         client.connected\_flag = \textcolor{keyword}{True}        
22         err\_cnt = 0
23 
24 
25         client.subscribe([(\textcolor{stringliteral}{"HANevse/getUsers"}, 2), (\textcolor{stringliteral}{"HANevse/UpdateUser"}, 2), (\textcolor{stringliteral}{"HANevse/photonMeasure"}, 2)]
      )
26         print(\textcolor{stringliteral}{"Connected OK"})
27     \textcolor{keywordflow}{else}:
28         print(\textcolor{stringliteral}{"Bad connection, RC = "}, rc)
29         client.bad\_connection\_flag = \textcolor{keyword}{True}
30         
\end{DoxyCode}
\mbox{\label{namespacea_s_q_lfunction_a3fedee86aa0e1ebea7003c0e8e622f26}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!on\+\_\+disconnect@{on\+\_\+disconnect}}
\index{on\+\_\+disconnect@{on\+\_\+disconnect}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{on\+\_\+disconnect()}
{\footnotesize\ttfamily def a\+S\+Q\+Lfunction.\+on\+\_\+disconnect (\begin{DoxyParamCaption}\item[{}]{client,  }\item[{}]{userdata,  }\item[{}]{rc }\end{DoxyParamCaption})}



Definition at line 31 of file a\+S\+Q\+Lfunction.\+py.



References on\+\_\+disconnect.


\begin{DoxyCode}
31 \textcolor{keyword}{def }on_disconnect(client, userdata, rc):
32     client.connected\_flag = \textcolor{keyword}{False}
33     \textcolor{keywordflow}{if} rc != 0:
34         print(\textcolor{stringliteral}{"Unexpected disconnection."})
35         client.bad\_connection\_flag = \textcolor{keyword}{True}
36     \textcolor{keywordflow}{else}:
37         print(\textcolor{stringliteral}{"Normal disconnection."})
38 
\end{DoxyCode}
\mbox{\label{namespacea_s_q_lfunction_a5e6d69ade03ee6bf5d9db95907f63725}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!photon\+Measure\+\_\+callback@{photon\+Measure\+\_\+callback}}
\index{photon\+Measure\+\_\+callback@{photon\+Measure\+\_\+callback}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{photon\+Measure\+\_\+callback()}
{\footnotesize\ttfamily def a\+S\+Q\+Lfunction.\+photon\+Measure\+\_\+callback (\begin{DoxyParamCaption}\item[{}]{client,  }\item[{}]{userdata,  }\item[{}]{message }\end{DoxyParamCaption})}



Definition at line 71 of file a\+S\+Q\+Lfunction.\+py.


\begin{DoxyCode}
71 \textcolor{keyword}{def }photonMeasure_callback(client, userdata, message):
72     con = lite.connect(path)
73     cur = con.cursor()
74     data = message.payload    
75     data = data.decode(\textcolor{stringliteral}{'UTF-8'})
76     print(data)
77     index = []
78     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(data)):
79         \textcolor{keywordflow}{if} (data[i] == \textcolor{stringliteral}{'%'}):
80             index.append(i)
81     V1 = float(data[:index[0]])
82     V2 = float(data[index[0]+1:index[1]])
83     V3 = float(data[index[1]+1:index[2]])
84     I1 = float(data[index[2]+1:index[3]])
85     I2 = float(data[index[3]+1:index[4]])
86     I3 = float(data[index[4]+1:index[5]])
87     P = float(data[index[5]+1:index[6]])
88     E = float(data[index[6]+1:index[7]])
89     F = float(data[index[7]+1:index[8]])
90     Time = int(data[index[8]+1:index[9]])
91     SocketID = int(data[index[9]+1:index[10]])
92     UserID = data[index[10]+1:index[11]]
93     cur.execute(\textcolor{stringliteral}{"INSERT INTO photonMeasure(UserID, SocketID, V1, V2, V3, I1, I2, I3, P, E, F, Time)
       VALUES(?,?,?,?,?,?,?,?,?,?,?,?)"},
94                 (UserID, SocketID, V1, V2, V3, I1, I2, I3, P, E, F, Time))
95     con.commit()
96     print(V1)
97 
98 \textcolor{comment}{#setup mqtt}
\end{DoxyCode}
\mbox{\label{namespacea_s_q_lfunction_ae474ee228c976aa102f3cf304049adbe}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!Send\+User\+\_\+callback@{Send\+User\+\_\+callback}}
\index{Send\+User\+\_\+callback@{Send\+User\+\_\+callback}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{Send\+User\+\_\+callback()}
{\footnotesize\ttfamily def a\+S\+Q\+Lfunction.\+Send\+User\+\_\+callback (\begin{DoxyParamCaption}\item[{}]{client,  }\item[{}]{userdata,  }\item[{}]{message }\end{DoxyParamCaption})}



Definition at line 39 of file a\+S\+Q\+Lfunction.\+py.


\begin{DoxyCode}
39 \textcolor{keyword}{def }SendUser_callback(client, userdata, message):
40     print(message.payload)
41     con = lite.connect(path)
42     cur = con.cursor()
43     cur.execute(\textcolor{stringliteral}{'select * from list'})
44 
45     data = cur.fetchall()
46     dataSend = \textcolor{stringliteral}{""}
47 
48     \textcolor{keywordflow}{for} element \textcolor{keywordflow}{in} data:
49         print(element)
50         dataSend += (str(element[0])+\textcolor{stringliteral}{'%'}+element[1]+\textcolor{stringliteral}{'%'}+element[2]+\textcolor{stringliteral}{'%'}+str(element[3])+\textcolor{stringliteral}{'%'}+element[4]+\textcolor{stringliteral}{'%'}+
      str(element[5])+\textcolor{stringliteral}{'%'}+element[6]+\textcolor{stringliteral}{'%'}+str(element[7])+\textcolor{stringliteral}{'%'}+str(element[8])+\textcolor{stringliteral}{'%'})
51     
52     client.publish(\textcolor{stringliteral}{"HANevse/UserList2"}, dataSend, 2, \textcolor{keyword}{True})
53     \textcolor{comment}{#publish.single("HANevse/UserList", dataSend, hostname=broker)}
54     print(dataSend)
55 
\end{DoxyCode}
\mbox{\label{namespacea_s_q_lfunction_a40a55f27b9f105e25bac6ed21417493a}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!Update\+\_\+callback@{Update\+\_\+callback}}
\index{Update\+\_\+callback@{Update\+\_\+callback}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{Update\+\_\+callback()}
{\footnotesize\ttfamily def a\+S\+Q\+Lfunction.\+Update\+\_\+callback (\begin{DoxyParamCaption}\item[{}]{client,  }\item[{}]{userdata,  }\item[{}]{message }\end{DoxyParamCaption})}



Definition at line 56 of file a\+S\+Q\+Lfunction.\+py.


\begin{DoxyCode}
56 \textcolor{keyword}{def }Update_callback(client, userdata, message):
57     con = lite.connect(path)
58     cur = con.cursor()
59     data = message.payload
60     index = []
61     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(data)):
62         \textcolor{keywordflow}{if} (data[i] == \textcolor{stringliteral}{'%'}):
63             index.append(i)
64     UserId = int(data[:index[0]])
65     PendingCharger = int(data[index[0]+1:index[1]])
66     StartTime = int(data[index[1]+1:index[2]])
67     cur.execute(\textcolor{stringliteral}{"UPDATE list SET PendingCharger=? WHERE Id=?"}, (PendingCharger, UserId))
68     cur.execute(\textcolor{stringliteral}{"UPDATE list SET StartTime=? WHERE Id=?"}, (StartTime, UserId))
69     con.commmit()
70 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\label{namespacea_s_q_lfunction_a5609027c55d514971243f61aa16b7d11}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!bad\+\_\+connection\+\_\+flag@{bad\+\_\+connection\+\_\+flag}}
\index{bad\+\_\+connection\+\_\+flag@{bad\+\_\+connection\+\_\+flag}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{bad\+\_\+connection\+\_\+flag}
{\footnotesize\ttfamily a\+S\+Q\+Lfunction.\+bad\+\_\+connection\+\_\+flag}



Definition at line 102 of file a\+S\+Q\+Lfunction.\+py.

\mbox{\label{namespacea_s_q_lfunction_ad2759b313d097ec4924585b1a0b46129}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!broker@{broker}}
\index{broker@{broker}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{broker}
{\footnotesize\ttfamily string a\+S\+Q\+Lfunction.\+broker = \char`\"{}broker.\+hivemq.\+com\char`\"{}}



Definition at line 8 of file a\+S\+Q\+Lfunction.\+py.

\mbox{\label{namespacea_s_q_lfunction_aae08a8e774667d74ca036f82b3636dbf}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!client@{client}}
\index{client@{client}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{client}
{\footnotesize\ttfamily a\+S\+Q\+Lfunction.\+client = mqtt.\+Client()}



Definition at line 99 of file a\+S\+Q\+Lfunction.\+py.

\mbox{\label{namespacea_s_q_lfunction_a6ea718b8577dc5b2f11c22829e3b4329}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!con@{con}}
\index{con@{con}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{con}
{\footnotesize\ttfamily a\+S\+Q\+Lfunction.\+con = None}



Definition at line 7 of file a\+S\+Q\+Lfunction.\+py.

\mbox{\label{namespacea_s_q_lfunction_aeaf33b658152029d8f12298efc6ce7b4}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!connected\+\_\+flag@{connected\+\_\+flag}}
\index{connected\+\_\+flag@{connected\+\_\+flag}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{connected\+\_\+flag}
{\footnotesize\ttfamily a\+S\+Q\+Lfunction.\+connected\+\_\+flag}



Definition at line 101 of file a\+S\+Q\+Lfunction.\+py.

\mbox{\label{namespacea_s_q_lfunction_ac3242142d0903ec68fa307f96717b80a}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!current\+\_\+time@{current\+\_\+time}}
\index{current\+\_\+time@{current\+\_\+time}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{current\+\_\+time}
{\footnotesize\ttfamily a\+S\+Q\+Lfunction.\+current\+\_\+time = time.\+ctime(time.\+time())}



Definition at line 122 of file a\+S\+Q\+Lfunction.\+py.

\mbox{\label{namespacea_s_q_lfunction_aa3df5e51b14fcdd44b933235dc825c77}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!err\+\_\+cnt@{err\+\_\+cnt}}
\index{err\+\_\+cnt@{err\+\_\+cnt}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{err\+\_\+cnt}
{\footnotesize\ttfamily int a\+S\+Q\+Lfunction.\+err\+\_\+cnt = 0}



Definition at line 15 of file a\+S\+Q\+Lfunction.\+py.

\mbox{\label{namespacea_s_q_lfunction_a679b92b10b4474abfd7266008d35abfd}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!on\+\_\+connect@{on\+\_\+connect}}
\index{on\+\_\+connect@{on\+\_\+connect}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{on\+\_\+connect}
{\footnotesize\ttfamily a\+S\+Q\+Lfunction.\+on\+\_\+connect}



Definition at line 103 of file a\+S\+Q\+Lfunction.\+py.



Referenced by on\+\_\+connect().

\mbox{\label{namespacea_s_q_lfunction_a4d3034297222fd94d22e5c715f237184}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!on\+\_\+disconnect@{on\+\_\+disconnect}}
\index{on\+\_\+disconnect@{on\+\_\+disconnect}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{on\+\_\+disconnect}
{\footnotesize\ttfamily a\+S\+Q\+Lfunction.\+on\+\_\+disconnect}



Definition at line 104 of file a\+S\+Q\+Lfunction.\+py.



Referenced by on\+\_\+disconnect().

\mbox{\label{namespacea_s_q_lfunction_a9a0e66c8f783467abaedfd92599bbce7}} 
\index{a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}!path@{path}}
\index{path@{path}!a\+S\+Q\+Lfunction@{a\+S\+Q\+Lfunction}}
\subsubsection{path}
{\footnotesize\ttfamily string a\+S\+Q\+Lfunction.\+path = \char`\"{}/media/usb/user\+List\char`\"{}}



Definition at line 13 of file a\+S\+Q\+Lfunction.\+py.

